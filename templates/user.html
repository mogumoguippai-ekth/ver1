{% extends "base.html" %}

{% block title %}プロフィール編集 - 私の望む暮らし{% endblock %}

{% block page_title %}プロフィール編集{% endblock %}

{% block nickname %}{{ session.get('nickname', 'ゲスト') }}{% endblock %}

{% block content %}
<div class="user-registration">
    <h2>私について 基本情報編集</h2>

    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="alert alert-success">
        {{ messages[0] }}
    </div>
    {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('update_user') }}" class="registration-form">
        <!-- ユーザーID (表示のみ) -->
        <div class="form-group">
            <label for="user_id">ユーザーID</label><br>
            <input type="text" id="user_id" value="{{ user[1] if user else '' }}" disabled class="disabled-input">
        </div>

        <!-- メールアドレス (表示 + 訂正ボタン) -->
        <div class="form-group">
            <label for="email">メールアドレス</label><br>
            <div class="input-with-button">
                <input type="email" id="email" value="{{ user[2] if user else '' }}" disabled class="disabled-input">
                <button type="button" class="edit-btn" onclick="toggleEdit('email')">訂正</button>
            </div>
            <div id="email-edit" class="edit-section" style="display: none;">
                <label for="new_email">訂正後</label>
                <input type="email" id="new_email" name="new_email" placeholder="新しいメールアドレスを入力">
            </div>
        </div>

        <!-- パスワード (表示 + 訂正ボタン) -->
        <div class="form-group">
            <label for="password">パスワード</label><br>
            <div class="input-with-button">
                <input type="password" id="password" value="********" disabled class="disabled-input">
                <button type="button" class="edit-btn" onclick="toggleEdit('password')">訂正</button>
            </div>
            <div id="password-edit" class="edit-section" style="display: none;">
                <label for="new_password">訂正後</label>
                <input type="password" id="new_password" name="new_password" placeholder="新しいパスワードを入力">
            </div>
        </div>

        <!-- 氏名 -->
        <div class="form-group">
            <label for="name">氏名</label><br>
            <input type="text" id="name" name="name" value="{{ user[5] if user and user[5] else '' }}" placeholder="氏名を入力">
        </div>

        <!-- フリガナ -->
        <div class="form-group">
            <label for="furigana">フリガナ</label><br>
            <input type="text" id="furigana" name="furigana" value="{{ user[6] if user and user[6] else '' }}" placeholder="フリガナを入力">
        </div>

        <!-- ニックネーム -->
        <div class="form-group">
            <label for="nickname">ニックネーム</label><br>
            <input type="text" id="nickname" name="nickname" value="{{ user[7] if user and user[7] else '' }}" placeholder="表示名を入力">
        </div>

        <!-- 性別 -->
        <div class="form-group">
            <label for="gender">性別</label>
            <select id="gender" name="gender">
                <option value="">選択してください</option>
                <option value="男" {% if user and user[8]=='男' %}selected{% endif %}>男</option>
                <option value="女" {% if user and user[8]=='女' %}selected{% endif %}>女</option>
                <option value="その他" {% if user and user[8]=='その他' %}selected{% endif %}>その他</option>
            </select>
        </div>

        <!-- 生年月日 -->
        <div class="form-group">
            <label for="birth_date">生年月日</label>
            <input type="date" id="birth_date" name="birth_date" value="{{ user[9] if user and user[9] else '' }}">
        </div>

        <!-- 家族情報 -->
        <div class="family-section">
            <h3>家族情報</h3>
            <div class="form-group">
                <label for="family_id1">家族ID1</label>
                <input type="number" id="family_id1" name="family_id1" value="{{ user[10] if user and user[10] else '' }}" placeholder="家族ID1">
            </div>

            <div class="form-group">
                <label for="family_id2">家族ID2</label>
                <input type="number" id="family_id2" name="family_id2" value="{{ user[11] if user and user[11] else '' }}" placeholder="家族ID2">
            </div>

            <div class="form-group">
                <label for="family_id3">家族ID3</label>
                <input type="number" id="family_id3" name="family_id3" value="{{ user[12] if user and user[12] else '' }}" placeholder="家族ID3">
            </div>
        </div>

        <!-- ボタン -->
        <div class="form-actions">
            <button type="submit" class="submit-btn">更新する</button>
            <button type="button" class="cancel-btn" onclick="window.location.href='{{ url_for('dashboard') }}'">キャンセル</button>
        </div>
    </form>
</div>

<script src="{{ url_for('static', filename='js/app.js') }}"></script>
{% endblock %}
